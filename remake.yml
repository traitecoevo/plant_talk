packages:
  - plant
  - grImport
  - callr

sources:
  - R

plot_options:
  6by4:
    width: 6
    height: 4
  4by4:
    width: 4
    height: 4

targets:
  all:
    quiet: true
    depends:
      - slides.pdf

  slides.pdf:
    command: xelatex_build_clean("slides.tex")
    depends:
      - figures

  figures:
    depends:
      - figures/fitness-1.pdf
      - figures/fitness-2.pdf
      - figures/fitness-3.pdf
      - figures/fitness-4.pdf
      - figures/lifecycle-1.pdf
      - figures/lifecycle-2.pdf
      - figures/plantmodel-1.pdf
      - figures/plantmodel-2.pdf
      - figures/plantmodel-3.pdf
      - figures/plantmodel-4.pdf
      - figures/plantmodel-5.pdf
      - figures/plantmodel-6.pdf
      - figures/plantmodel-7.pdf
      - figures/lightenv-1.pdf
      - figures/lightenv-2.pdf
      - figures/lightenv-3.pdf
      - figures/blackbox.pdf
      - figures/blackbox-small.pdf
      - figures/competition-1.pdf
      - figures/competition-2.pdf
      - figures/competition-3.pdf

  # data objects
  res:
    command: simulation()
  seed:
    command:
      - get.pic("pics/acorn.eps")
      - colour.picture(., I("black"))
  tree:
    command: get.pic("pics/tree.eps")

  # figures
  figures/fitness-1.pdf:
    command: fig.fitness(1, seed, tree, res)
    plot: 6by4

  figures/fitness-2.pdf:
    command: fig.fitness(2, seed, tree, res)
    plot: 6by4

  figures/fitness-3.pdf:
    command: fig.fitness(3, seed, tree, res)
    plot: 6by4

  figures/fitness-4.pdf:
    command: fig.fitness(4, seed, tree, res)
    plot: 6by4

  figures/lifecycle-1.pdf:
    command: fig.lifecycle(1, seed, tree)
    plot: 4by4
  figures/lifecycle-2.pdf:
    command: fig.lifecycle(2, seed, tree)
    plot: 4by4

  figures/plantmodel-1.pdf:
    command: fig.plantmodel(1, tree, res)
    plot: 6by4
  figures/plantmodel-2.pdf:
    command: fig.plantmodel(2, tree, res)
    plot: 6by4
  figures/plantmodel-3.pdf:
    command: fig.plantmodel(3, tree, res)
    plot: 6by4
  figures/plantmodel-4.pdf:
    command: fig.plantmodel(4, tree, res)
    plot: 6by4
  figures/plantmodel-5.pdf:
    command: fig.plantmodel(5, tree, res)
    plot: 6by4
  figures/plantmodel-6.pdf:
    command: fig.plantmodel(6, tree, res)
    plot: 6by4
  figures/plantmodel-7.pdf:
    command: fig.plantmodel(7, tree, res)
    plot: 6by4

  figures/lightenv-1.pdf:
    command: fig.lightenv(1, tree, res)
    plot: 6by4
  figures/lightenv-2.pdf:
    command: fig.lightenv(2, tree, res)
    plot: 6by4
  figures/lightenv-3.pdf:
    command: fig.lightenv(3, tree, res)
    plot: 6by4

  figures/blackbox.pdf:
    command: fig.blackbox(tree, res)
    plot: 4by4
  figures/blackbox-small.pdf:
    command: fig.blackbox(tree, res, embed=TRUE)
    plot: 4by4

  figures/competition-1.pdf:
    command: fig.competition(1)
    plot: 6by4
  figures/competition-2.pdf:
    command: fig.competition(2)
    plot: 6by4
  figures/competition-3.pdf:
    command: fig.competition(3)
    plot: 6by4
